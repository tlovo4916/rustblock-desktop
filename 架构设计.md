# RustBlock Desktop 项目架构分析

## 项目描述

请使用一个成熟的技术栈，基于良好的可维护性和扩展性，开发一个完整的跨平台桌面应用程序，提供类似 Scratch 的可视化编程环境，专门用于10岁以下小朋友学习 Arduino、micro:bit等硬件设备的编程。


## 项目概述

RustBlock Desktop 是一个跨平台桌面应用程序，提供类似 Scratch 的可视化编程环境，专门用于10岁以下小朋友学习 Arduino、micro:bit等硬件设备的编程。

## 基本信息
- **项目名称**: RustBlock Desktop
- **当前版本**: 0.0.1
- **开发团队**: supiedt Team
- **支持平台**: Windows, macOS

## 技术栈要求
Tauri框架 Rust+Web语言


## 技术要求

### 1. 跨平台兼容性
- Windows平台和macOS平台需要统一代码， 统一接口
- 处理不同操作系统的串口通信差异

### 2. 硬件生态集成
- 支持多种硬件平台：Arduino 系列、micro:bit等（后续方便增加新系列-例如ESP32系列）
- 实现多种设备的特定通信协议
- 实时串口通信和设备状态监控
- 提供稳定可靠的硬件烧录功能
- 完善的错误处理和自动恢复机制

### 3. 教育友好设计
- 基于 Scratch 的可视化编程界面，降低编程学习门槛
- 支持实时模式和上传模式，适应不同教学场景

### 4. 现代化开发
- 模块化的代码组织结构
- 自动化的构建和发布流程
- 完善的错误处理和日志记录

### 5. AI功能
- 首页使用deepseek v3 对话功能-可以快速帮助
- 使用deepseek r1 分析和阅读代码报错并直接优化代码
- 用户可以自行设置api和提示词


## 核心功能模块要求

### A. 设备管理模块
- 硬件设备检测和识别
- 串口通信管理
- 设备驱动程序管理
- 固件烧录功能

### B. 编程环境模块
- Scratch式可视化编程界面
- 代码生成 (Arduino C++/MicroPython)
- 项目文件管理
- 扩展支持

### C. ai模块
- ai对话模块使用deepseek v3 面向10岁以下小朋友 回答简单 有引导性 具备平台使用的基础知识 
- ai纠错模块使用deepseek r1 可以分析和总结用户代码问题并选择是否要一键优化

## 硬件设备通信（烧录）实现机制

### 核心通信流程

```
硬件通信架构
├── 前端
│   ├── Scratch编程界面 → 生成代码
│   ├── 设备选择和连接UI  
│   └── 上传进度和日志显示
├── 主进程
│   ├── 
└── 核心通信库
```


## 硬件通信和烧录的详细流程

### A. 设备检测和连接流程
```
1. 串口扫描
   ├── 在不同设备上扫描可用串口
   ├── 根据硬件VID/PID识别设备类型
   ├── 匹配预定义的设备配置
   └── 返回可连接设备列表

2. 设备识别
   ├── Arduino (Uno, Nano...)
   ├── micro:bit (V1/V2)
   ├── 树莓派Pico系列
   ├── esp32系列
   └── 第三方兼容板等
```

### B. Arduino代码的编译和烧录流程
```
1. 代码生成阶段
// 在对应gui中完成
Scratch积木程序 → Arduino 代码
├── 积木逻辑处理
├── 积木定义和代码生成
└── 生成标准Arduino .ino代码

2. 编译阶段 (使用Arduino CLI)

3. 烧录阶段

```

### C. 实时通信模式
```
1. Firmata固件烧录

2. 实时通信协议

```

### D. MicroPython设备支持

```
// micro:bit MicroPython模式
MicroPython流程:
1. 生成Python代码 (而非Arduino代码)
2. 使用工具烧录.py文件
3. 通过串口交互
4. 支持实时代码执行和调试

```